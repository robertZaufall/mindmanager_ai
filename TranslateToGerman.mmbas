'#Language "WWB-COM"
'#Uses "Mermaid.cls"
'#Uses "MermaidToDocument.cls"
'#Uses "Settings.cls"
'#Uses "GptRequest.cls"

Option Explicit

Sub Main()
	Dim Settings As New Settings
    Dim GptRequest As New GptRequest

    Dim Mermaid As New Mermaid
    Dim MermaidToDocument As New MermaidToDocument

    Dim doc As Document
    Set doc = ActiveDocument

    Dim mermaidText As String
    mermaidText = Mermaid.GetDocumentAsMermaid(doc)

    Dim strSystem As String
    Dim strUser As String
	strSystem = "You are a helpful assistant."
	strUser = "Given is the following Mermaid mindmap. Please translate every topic to the German language " + _
		"and return the same mermaid structure back with two spaces as indentation: \n" + Replace(mermaidText, vbCr, "\n")

	Settings.MaxTokens = "1000"

	Dim NewMermaidText As String
	NewMermaidText = Replace(GptRequest.Gpt4Request(Settings, strSystem, strUser), "\n", vbCr)

    MermaidToDocument.NewDocumentFromMermaid(NewMermaidText)
End Sub
